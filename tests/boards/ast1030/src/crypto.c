/*
 * Copyright (c) 2021 Aspeed Technology Inc.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
#include <ztest.h>
#include "ast_test.h"
#include <crypto/hash.h>
#include <crypto/rsa.h>

struct hash_testvec {
	const char *plaintext;
	const char *digest;
	unsigned int psize;
};

static const struct hash_testvec sha512_tv_template[] = {
	{
		.plaintext = "",
		.psize	= 0,
		.digest	= "\xcf\x83\xe1\x35\x7e\xef\xb8\xbd"
		"\xf1\x54\x28\x50\xd6\x6d\x80\x07"
		"\xd6\x20\xe4\x05\x0b\x57\x15\xdc"
		"\x83\xf4\xa9\x21\xd3\x6c\xe9\xce"
		"\x47\xd0\xd1\x3c\x5d\x85\xf2\xb0"
		"\xff\x83\x18\xd2\x87\x7e\xec\x2f"
		"\x63\xb9\x31\xbd\x47\x41\x7a\x81"
		"\xa5\x38\x32\x7a\xf9\x27\xda\x3e",
	}, {
		.plaintext = "abc",
		.psize	= 3,
		.digest	= "\xdd\xaf\x35\xa1\x93\x61\x7a\xba"
		"\xcc\x41\x73\x49\xae\x20\x41\x31"
		"\x12\xe6\xfa\x4e\x89\xa9\x7e\xa2"
		"\x0a\x9e\xee\xe6\x4b\x55\xd3\x9a"
		"\x21\x92\x99\x2a\x27\x4f\xc1\xa8"
		"\x36\xba\x3c\x23\xa3\xfe\xeb\xbd"
		"\x45\x4d\x44\x23\x64\x3c\xe8\x0e"
		"\x2a\x9a\xc9\x4f\xa5\x4c\xa4\x9f",
	}, {
		.plaintext = "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq",
		.psize	= 56,
		.digest	= "\x20\x4a\x8f\xc6\xdd\xa8\x2f\x0a"
		"\x0c\xed\x7b\xeb\x8e\x08\xa4\x16"
		"\x57\xc1\x6e\xf4\x68\xb2\x28\xa8"
		"\x27\x9b\xe3\x31\xa7\x03\xc3\x35"
		"\x96\xfd\x15\xc1\x3b\x1b\x07\xf9"
		"\xaa\x1d\x3b\xea\x57\x78\x9c\xa0"
		"\x31\xad\x85\xc7\xa7\x1d\xd7\x03"
		"\x54\xec\x63\x12\x38\xca\x34\x45",
	}, {
		.plaintext = "abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmn"
		"hijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu",
		.psize	= 112,
		.digest	= "\x8e\x95\x9b\x75\xda\xe3\x13\xda"
		"\x8c\xf4\xf7\x28\x14\xfc\x14\x3f"
		"\x8f\x77\x79\xc6\xeb\x9f\x7f\xa1"
		"\x72\x99\xae\xad\xb6\x88\x90\x18"
		"\x50\x1d\x28\x9e\x49\x00\xf7\xe4"
		"\x33\x1b\x99\xde\xc4\xb5\x43\x3a"
		"\xc7\xd3\x29\xee\xb6\xdd\x26\x54"
		"\x5e\x96\xe5\x5b\x87\x4b\xe9\x09",
	}, {
		.plaintext = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcd"
		"efghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz",
		.psize	= 104,
		.digest	= "\x93\x0d\x0c\xef\xcb\x30\xff\x11"
		"\x33\xb6\x89\x81\x21\xf1\xcf\x3d"
		"\x27\x57\x8a\xfc\xaf\xe8\x67\x7c"
		"\x52\x57\xcf\x06\x99\x11\xf7\x5d"
		"\x8f\x58\x31\xb5\x6e\xbf\xda\x67"
		"\xb2\x78\xe6\x6d\xff\x8b\x84\xfe"
		"\x2b\x28\x70\xf7\x42\xa5\x80\xd8"
		"\xed\xb4\x19\x87\x23\x28\x50\xc9",
	}, {
		.plaintext = "\x08\x9f\x13\xaa\x41\xd8\x4c\xe3"
		"\x7a\x11\x85\x1c\xb3\x27\xbe\x55"
		"\xec\x60\xf7\x8e\x02\x99\x30\xc7"
		"\x3b\xd2\x69\x00\x74\x0b\xa2\x16"
		"\xad\x44\xdb\x4f\xe6\x7d\x14\x88"
		"\x1f\xb6\x2a\xc1\x58\xef\x63\xfa"
		"\x91\x05\x9c\x33\xca\x3e\xd5\x6c"
		"\x03\x77\x0e\xa5\x19\xb0\x47\xde"
		"\x52\xe9\x80\x17\x8b\x22\xb9\x2d"
		"\xc4\x5b\xf2\x66\xfd\x94\x08\x9f"
		"\x36\xcd\x41\xd8\x6f\x06\x7a\x11"
		"\xa8\x1c\xb3\x4a\xe1\x55\xec\x83"
		"\x1a\x8e\x25\xbc\x30\xc7\x5e\xf5"
		"\x69\x00\x97\x0b\xa2\x39\xd0\x44"
		"\xdb\x72\x09\x7d\x14\xab\x1f\xb6"
		"\x4d\xe4\x58\xef\x86\x1d\x91\x28"
		"\xbf\x33\xca\x61\xf8\x6c\x03\x9a"
		"\x0e\xa5\x3c\xd3\x47\xde\x75\x0c"
		"\x80\x17\xae\x22\xb9\x50\xe7\x5b"
		"\xf2\x89\x20\x94\x2b\xc2\x36\xcd"
		"\x64\xfb\x6f\x06\x9d\x11\xa8\x3f"
		"\xd6\x4a\xe1\x78\x0f\x83\x1a\xb1"
		"\x25\xbc\x53\xea\x5e\xf5\x8c\x00"
		"\x97\x2e\xc5\x39\xd0\x67\xfe\x72"
		"\x09\xa0\x14\xab\x42\xd9\x4d\xe4"
		"\x7b\x12\x86\x1d\xb4\x28\xbf\x56"
		"\xed\x61\xf8\x8f\x03\x9a\x31\xc8"
		"\x3c\xd3\x6a\x01\x75\x0c\xa3\x17"
		"\xae\x45\xdc\x50\xe7\x7e\x15\x89"
		"\x20\xb7\x2b\xc2\x59\xf0\x64\xfb"
		"\x92\x06\x9d\x34\xcb\x3f\xd6\x6d"
		"\x04\x78\x0f\xa6\x1a\xb1\x48\xdf"
		"\x53\xea\x81\x18\x8c\x23\xba\x2e"
		"\xc5\x5c\xf3\x67\xfe\x95\x09\xa0"
		"\x37\xce\x42\xd9\x70\x07\x7b\x12"
		"\xa9\x1d\xb4\x4b\xe2\x56\xed\x84"
		"\x1b\x8f\x26\xbd\x31\xc8\x5f\xf6"
		"\x6a\x01\x98\x0c\xa3\x3a\xd1\x45"
		"\xdc\x73\x0a\x7e\x15\xac\x20\xb7"
		"\x4e\xe5\x59\xf0\x87\x1e\x92\x29"
		"\xc0\x34\xcb\x62\xf9\x6d\x04\x9b"
		"\x0f\xa6\x3d\xd4\x48\xdf\x76\x0d"
		"\x81\x18\xaf\x23\xba\x51\xe8\x5c"
		"\xf3\x8a\x21\x95\x2c\xc3\x37\xce"
		"\x65\xfc\x70\x07\x9e\x12\xa9\x40"
		"\xd7\x4b\xe2\x79\x10\x84\x1b\xb2"
		"\x26\xbd\x54\xeb\x5f\xf6\x8d\x01"
		"\x98\x2f\xc6\x3a\xd1\x68\xff\x73"
		"\x0a\xa1\x15\xac\x43\xda\x4e\xe5"
		"\x7c\x13\x87\x1e\xb5\x29\xc0\x57"
		"\xee\x62\xf9\x90\x04\x9b\x32\xc9"
		"\x3d\xd4\x6b\x02\x76\x0d\xa4\x18"
		"\xaf\x46\xdd\x51\xe8\x7f\x16\x8a"
		"\x21\xb8\x2c\xc3\x5a\xf1\x65\xfc"
		"\x93\x07\x9e\x35\xcc\x40\xd7\x6e"
		"\x05\x79\x10\xa7\x1b\xb2\x49\xe0"
		"\x54\xeb\x82\x19\x8d\x24\xbb\x2f"
		"\xc6\x5d\xf4\x68\xff\x96\x0a\xa1"
		"\x38\xcf\x43\xda\x71\x08\x7c\x13"
		"\xaa\x1e\xb5\x4c\xe3\x57\xee\x85"
		"\x1c\x90\x27\xbe\x32\xc9\x60\xf7"
		"\x6b\x02\x99\x0d\xa4\x3b\xd2\x46"
		"\xdd\x74\x0b\x7f\x16\xad\x21\xb8"
		"\x4f\xe6\x5a\xf1\x88\x1f\x93\x2a"
		"\xc1\x35\xcc\x63\xfa\x6e\x05\x9c"
		"\x10\xa7\x3e\xd5\x49\xe0\x77\x0e"
		"\x82\x19\xb0\x24\xbb\x52\xe9\x5d"
		"\xf4\x8b\x22\x96\x2d\xc4\x38\xcf"
		"\x66\xfd\x71\x08\x9f\x13\xaa\x41"
		"\xd8\x4c\xe3\x7a\x11\x85\x1c\xb3"
		"\x27\xbe\x55\xec\x60\xf7\x8e\x02"
		"\x99\x30\xc7\x3b\xd2\x69\x00\x74"
		"\x0b\xa2\x16\xad\x44\xdb\x4f\xe6"
		"\x7d\x14\x88\x1f\xb6\x2a\xc1\x58"
		"\xef\x63\xfa\x91\x05\x9c\x33\xca"
		"\x3e\xd5\x6c\x03\x77\x0e\xa5\x19"
		"\xb0\x47\xde\x52\xe9\x80\x17\x8b"
		"\x22\xb9\x2d\xc4\x5b\xf2\x66\xfd"
		"\x94\x08\x9f\x36\xcd\x41\xd8\x6f"
		"\x06\x7a\x11\xa8\x1c\xb3\x4a\xe1"
		"\x55\xec\x83\x1a\x8e\x25\xbc\x30"
		"\xc7\x5e\xf5\x69\x00\x97\x0b\xa2"
		"\x39\xd0\x44\xdb\x72\x09\x7d\x14"
		"\xab\x1f\xb6\x4d\xe4\x58\xef\x86"
		"\x1d\x91\x28\xbf\x33\xca\x61\xf8"
		"\x6c\x03\x9a\x0e\xa5\x3c\xd3\x47"
		"\xde\x75\x0c\x80\x17\xae\x22\xb9"
		"\x50\xe7\x5b\xf2\x89\x20\x94\x2b"
		"\xc2\x36\xcd\x64\xfb\x6f\x06\x9d"
		"\x11\xa8\x3f\xd6\x4a\xe1\x78\x0f"
		"\x83\x1a\xb1\x25\xbc\x53\xea\x5e"
		"\xf5\x8c\x00\x97\x2e\xc5\x39\xd0"
		"\x67\xfe\x72\x09\xa0\x14\xab\x42"
		"\xd9\x4d\xe4\x7b\x12\x86\x1d\xb4"
		"\x28\xbf\x56\xed\x61\xf8\x8f\x03"
		"\x9a\x31\xc8\x3c\xd3\x6a\x01\x75"
		"\x0c\xa3\x17\xae\x45\xdc\x50\xe7"
		"\x7e\x15\x89\x20\xb7\x2b\xc2\x59"
		"\xf0\x64\xfb\x92\x06\x9d\x34\xcb"
		"\x3f\xd6\x6d\x04\x78\x0f\xa6\x1a"
		"\xb1\x48\xdf\x53\xea\x81\x18\x8c"
		"\x23\xba\x2e\xc5\x5c\xf3\x67\xfe"
		"\x95\x09\xa0\x37\xce\x42\xd9\x70"
		"\x07\x7b\x12\xa9\x1d\xb4\x4b\xe2"
		"\x56\xed\x84\x1b\x8f\x26\xbd\x31"
		"\xc8\x5f\xf6\x6a\x01\x98\x0c\xa3"
		"\x3a\xd1\x45\xdc\x73\x0a\x7e\x15"
		"\xac\x20\xb7\x4e\xe5\x59\xf0\x87"
		"\x1e\x92\x29\xc0\x34\xcb\x62\xf9"
		"\x6d\x04\x9b\x0f\xa6\x3d\xd4\x48"
		"\xdf\x76\x0d\x81\x18\xaf\x23\xba"
		"\x51\xe8\x5c\xf3\x8a\x21\x95\x2c"
		"\xc3\x37\xce\x65\xfc\x70\x07\x9e"
		"\x12\xa9\x40\xd7\x4b\xe2\x79\x10"
		"\x84\x1b\xb2\x26\xbd\x54\xeb\x5f"
		"\xf6\x8d\x01\x98\x2f\xc6\x3a\xd1"
		"\x68\xff\x73\x0a\xa1\x15\xac\x43"
		"\xda\x4e\xe5\x7c\x13\x87\x1e\xb5"
		"\x29\xc0\x57\xee\x62\xf9\x90\x04"
		"\x9b\x32\xc9\x3d\xd4\x6b\x02\x76"
		"\x0d\xa4\x18\xaf\x46\xdd\x51\xe8"
		"\x7f\x16\x8a\x21\xb8\x2c\xc3\x5a"
		"\xf1\x65\xfc\x93\x07\x9e\x35\xcc"
		"\x40\xd7\x6e\x05\x79\x10\xa7\x1b"
		"\xb2\x49\xe0\x54\xeb\x82\x19\x8d"
		"\x24\xbb\x2f\xc6\x5d\xf4\x68\xff"
		"\x96\x0a\xa1\x38\xcf\x43\xda\x71"
		"\x08\x7c\x13\xaa\x1e\xb5\x4c",
		.psize     = 1023,
		.digest    = "\x76\xc9\xd4\x91\x7a\x5f\x0f\xaa"
		"\x13\x39\xf3\x01\x7a\xfa\xe5\x41"
		"\x5f\x0b\xf8\xeb\x32\xfc\xbf\xb0"
		"\xfa\x8c\xcd\x17\x83\xe2\xfa\xeb"
		"\x1c\x19\xde\xe2\x75\xdc\x34\x64"
		"\x5f\x35\x9c\x61\x2f\x10\xf9\xec"
		"\x59\xca\x9d\xcc\x25\x0c\x43\xba"
		"\x85\xa8\xf8\xfe\xb5\x24\xb2\xee",
	}
};

static const struct hash_testvec sha384_tv_template[] = {
	{
		.plaintext = "",
		.psize	= 0,
		.digest	= "\x38\xb0\x60\xa7\x51\xac\x96\x38"
		"\x4c\xd9\x32\x7e\xb1\xb1\xe3\x6a"
		"\x21\xfd\xb7\x11\x14\xbe\x07\x43"
		"\x4c\x0c\xc7\xbf\x63\xf6\xe1\xda"
		"\x27\x4e\xde\xbf\xe7\x6f\x65\xfb"
		"\xd5\x1a\xd2\xf1\x48\x98\xb9\x5b",
	}, {
		.plaintext = "abc",
		.psize	= 3,
		.digest	= "\xcb\x00\x75\x3f\x45\xa3\x5e\x8b"
		"\xb5\xa0\x3d\x69\x9a\xc6\x50\x07"
		"\x27\x2c\x32\xab\x0e\xde\xd1\x63"
		"\x1a\x8b\x60\x5a\x43\xff\x5b\xed"
		"\x80\x86\x07\x2b\xa1\xe7\xcc\x23"
		"\x58\xba\xec\xa1\x34\xc8\x25\xa7",
	}, {
		.plaintext = "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq",
		.psize	= 56,
		.digest	= "\x33\x91\xfd\xdd\xfc\x8d\xc7\x39"
		"\x37\x07\xa6\x5b\x1b\x47\x09\x39"
		"\x7c\xf8\xb1\xd1\x62\xaf\x05\xab"
		"\xfe\x8f\x45\x0d\xe5\xf3\x6b\xc6"
		"\xb0\x45\x5a\x85\x20\xbc\x4e\x6f"
		"\x5f\xe9\x5b\x1f\xe3\xc8\x45\x2b",
	}, {
		.plaintext = "abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmn"
		"hijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu",
		.psize	= 112,
		.digest	= "\x09\x33\x0c\x33\xf7\x11\x47\xe8"
		"\x3d\x19\x2f\xc7\x82\xcd\x1b\x47"
		"\x53\x11\x1b\x17\x3b\x3b\x05\xd2"
		"\x2f\xa0\x80\x86\xe3\xb0\xf7\x12"
		"\xfc\xc7\xc7\x1a\x55\x7e\x2d\xb9"
		"\x66\xc3\xe9\xfa\x91\x74\x60\x39",
	}, {
		.plaintext = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcd"
		"efghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz",
		.psize	= 104,
		.digest	= "\x3d\x20\x89\x73\xab\x35\x08\xdb"
		"\xbd\x7e\x2c\x28\x62\xba\x29\x0a"
		"\xd3\x01\x0e\x49\x78\xc1\x98\xdc"
		"\x4d\x8f\xd0\x14\xe5\x82\x82\x3a"
		"\x89\xe1\x6f\x9b\x2a\x7b\xbc\x1a"
		"\xc9\x38\xe2\xd1\x99\xe8\xbe\xa4",
	}, {
		.plaintext = "\x08\x9f\x13\xaa\x41\xd8\x4c\xe3"
		"\x7a\x11\x85\x1c\xb3\x27\xbe\x55"
		"\xec\x60\xf7\x8e\x02\x99\x30\xc7"
		"\x3b\xd2\x69\x00\x74\x0b\xa2\x16"
		"\xad\x44\xdb\x4f\xe6\x7d\x14\x88"
		"\x1f\xb6\x2a\xc1\x58\xef\x63\xfa"
		"\x91\x05\x9c\x33\xca\x3e\xd5\x6c"
		"\x03\x77\x0e\xa5\x19\xb0\x47\xde"
		"\x52\xe9\x80\x17\x8b\x22\xb9\x2d"
		"\xc4\x5b\xf2\x66\xfd\x94\x08\x9f"
		"\x36\xcd\x41\xd8\x6f\x06\x7a\x11"
		"\xa8\x1c\xb3\x4a\xe1\x55\xec\x83"
		"\x1a\x8e\x25\xbc\x30\xc7\x5e\xf5"
		"\x69\x00\x97\x0b\xa2\x39\xd0\x44"
		"\xdb\x72\x09\x7d\x14\xab\x1f\xb6"
		"\x4d\xe4\x58\xef\x86\x1d\x91\x28"
		"\xbf\x33\xca\x61\xf8\x6c\x03\x9a"
		"\x0e\xa5\x3c\xd3\x47\xde\x75\x0c"
		"\x80\x17\xae\x22\xb9\x50\xe7\x5b"
		"\xf2\x89\x20\x94\x2b\xc2\x36\xcd"
		"\x64\xfb\x6f\x06\x9d\x11\xa8\x3f"
		"\xd6\x4a\xe1\x78\x0f\x83\x1a\xb1"
		"\x25\xbc\x53\xea\x5e\xf5\x8c\x00"
		"\x97\x2e\xc5\x39\xd0\x67\xfe\x72"
		"\x09\xa0\x14\xab\x42\xd9\x4d\xe4"
		"\x7b\x12\x86\x1d\xb4\x28\xbf\x56"
		"\xed\x61\xf8\x8f\x03\x9a\x31\xc8"
		"\x3c\xd3\x6a\x01\x75\x0c\xa3\x17"
		"\xae\x45\xdc\x50\xe7\x7e\x15\x89"
		"\x20\xb7\x2b\xc2\x59\xf0\x64\xfb"
		"\x92\x06\x9d\x34\xcb\x3f\xd6\x6d"
		"\x04\x78\x0f\xa6\x1a\xb1\x48\xdf"
		"\x53\xea\x81\x18\x8c\x23\xba\x2e"
		"\xc5\x5c\xf3\x67\xfe\x95\x09\xa0"
		"\x37\xce\x42\xd9\x70\x07\x7b\x12"
		"\xa9\x1d\xb4\x4b\xe2\x56\xed\x84"
		"\x1b\x8f\x26\xbd\x31\xc8\x5f\xf6"
		"\x6a\x01\x98\x0c\xa3\x3a\xd1\x45"
		"\xdc\x73\x0a\x7e\x15\xac\x20\xb7"
		"\x4e\xe5\x59\xf0\x87\x1e\x92\x29"
		"\xc0\x34\xcb\x62\xf9\x6d\x04\x9b"
		"\x0f\xa6\x3d\xd4\x48\xdf\x76\x0d"
		"\x81\x18\xaf\x23\xba\x51\xe8\x5c"
		"\xf3\x8a\x21\x95\x2c\xc3\x37\xce"
		"\x65\xfc\x70\x07\x9e\x12\xa9\x40"
		"\xd7\x4b\xe2\x79\x10\x84\x1b\xb2"
		"\x26\xbd\x54\xeb\x5f\xf6\x8d\x01"
		"\x98\x2f\xc6\x3a\xd1\x68\xff\x73"
		"\x0a\xa1\x15\xac\x43\xda\x4e\xe5"
		"\x7c\x13\x87\x1e\xb5\x29\xc0\x57"
		"\xee\x62\xf9\x90\x04\x9b\x32\xc9"
		"\x3d\xd4\x6b\x02\x76\x0d\xa4\x18"
		"\xaf\x46\xdd\x51\xe8\x7f\x16\x8a"
		"\x21\xb8\x2c\xc3\x5a\xf1\x65\xfc"
		"\x93\x07\x9e\x35\xcc\x40\xd7\x6e"
		"\x05\x79\x10\xa7\x1b\xb2\x49\xe0"
		"\x54\xeb\x82\x19\x8d\x24\xbb\x2f"
		"\xc6\x5d\xf4\x68\xff\x96\x0a\xa1"
		"\x38\xcf\x43\xda\x71\x08\x7c\x13"
		"\xaa\x1e\xb5\x4c\xe3\x57\xee\x85"
		"\x1c\x90\x27\xbe\x32\xc9\x60\xf7"
		"\x6b\x02\x99\x0d\xa4\x3b\xd2\x46"
		"\xdd\x74\x0b\x7f\x16\xad\x21\xb8"
		"\x4f\xe6\x5a\xf1\x88\x1f\x93\x2a"
		"\xc1\x35\xcc\x63\xfa\x6e\x05\x9c"
		"\x10\xa7\x3e\xd5\x49\xe0\x77\x0e"
		"\x82\x19\xb0\x24\xbb\x52\xe9\x5d"
		"\xf4\x8b\x22\x96\x2d\xc4\x38\xcf"
		"\x66\xfd\x71\x08\x9f\x13\xaa\x41"
		"\xd8\x4c\xe3\x7a\x11\x85\x1c\xb3"
		"\x27\xbe\x55\xec\x60\xf7\x8e\x02"
		"\x99\x30\xc7\x3b\xd2\x69\x00\x74"
		"\x0b\xa2\x16\xad\x44\xdb\x4f\xe6"
		"\x7d\x14\x88\x1f\xb6\x2a\xc1\x58"
		"\xef\x63\xfa\x91\x05\x9c\x33\xca"
		"\x3e\xd5\x6c\x03\x77\x0e\xa5\x19"
		"\xb0\x47\xde\x52\xe9\x80\x17\x8b"
		"\x22\xb9\x2d\xc4\x5b\xf2\x66\xfd"
		"\x94\x08\x9f\x36\xcd\x41\xd8\x6f"
		"\x06\x7a\x11\xa8\x1c\xb3\x4a\xe1"
		"\x55\xec\x83\x1a\x8e\x25\xbc\x30"
		"\xc7\x5e\xf5\x69\x00\x97\x0b\xa2"
		"\x39\xd0\x44\xdb\x72\x09\x7d\x14"
		"\xab\x1f\xb6\x4d\xe4\x58\xef\x86"
		"\x1d\x91\x28\xbf\x33\xca\x61\xf8"
		"\x6c\x03\x9a\x0e\xa5\x3c\xd3\x47"
		"\xde\x75\x0c\x80\x17\xae\x22\xb9"
		"\x50\xe7\x5b\xf2\x89\x20\x94\x2b"
		"\xc2\x36\xcd\x64\xfb\x6f\x06\x9d"
		"\x11\xa8\x3f\xd6\x4a\xe1\x78\x0f"
		"\x83\x1a\xb1\x25\xbc\x53\xea\x5e"
		"\xf5\x8c\x00\x97\x2e\xc5\x39\xd0"
		"\x67\xfe\x72\x09\xa0\x14\xab\x42"
		"\xd9\x4d\xe4\x7b\x12\x86\x1d\xb4"
		"\x28\xbf\x56\xed\x61\xf8\x8f\x03"
		"\x9a\x31\xc8\x3c\xd3\x6a\x01\x75"
		"\x0c\xa3\x17\xae\x45\xdc\x50\xe7"
		"\x7e\x15\x89\x20\xb7\x2b\xc2\x59"
		"\xf0\x64\xfb\x92\x06\x9d\x34\xcb"
		"\x3f\xd6\x6d\x04\x78\x0f\xa6\x1a"
		"\xb1\x48\xdf\x53\xea\x81\x18\x8c"
		"\x23\xba\x2e\xc5\x5c\xf3\x67\xfe"
		"\x95\x09\xa0\x37\xce\x42\xd9\x70"
		"\x07\x7b\x12\xa9\x1d\xb4\x4b\xe2"
		"\x56\xed\x84\x1b\x8f\x26\xbd\x31"
		"\xc8\x5f\xf6\x6a\x01\x98\x0c\xa3"
		"\x3a\xd1\x45\xdc\x73\x0a\x7e\x15"
		"\xac\x20\xb7\x4e\xe5\x59\xf0\x87"
		"\x1e\x92\x29\xc0\x34\xcb\x62\xf9"
		"\x6d\x04\x9b\x0f\xa6\x3d\xd4\x48"
		"\xdf\x76\x0d\x81\x18\xaf\x23\xba"
		"\x51\xe8\x5c\xf3\x8a\x21\x95\x2c"
		"\xc3\x37\xce\x65\xfc\x70\x07\x9e"
		"\x12\xa9\x40\xd7\x4b\xe2\x79\x10"
		"\x84\x1b\xb2\x26\xbd\x54\xeb\x5f"
		"\xf6\x8d\x01\x98\x2f\xc6\x3a\xd1"
		"\x68\xff\x73\x0a\xa1\x15\xac\x43"
		"\xda\x4e\xe5\x7c\x13\x87\x1e\xb5"
		"\x29\xc0\x57\xee\x62\xf9\x90\x04"
		"\x9b\x32\xc9\x3d\xd4\x6b\x02\x76"
		"\x0d\xa4\x18\xaf\x46\xdd\x51\xe8"
		"\x7f\x16\x8a\x21\xb8\x2c\xc3\x5a"
		"\xf1\x65\xfc\x93\x07\x9e\x35\xcc"
		"\x40\xd7\x6e\x05\x79\x10\xa7\x1b"
		"\xb2\x49\xe0\x54\xeb\x82\x19\x8d"
		"\x24\xbb\x2f\xc6\x5d\xf4\x68\xff"
		"\x96\x0a\xa1\x38\xcf\x43\xda\x71"
		"\x08\x7c\x13\xaa\x1e\xb5\x4c",
		.psize     = 1023,
		.digest    = "\x4d\x97\x23\xc8\xea\x7a\x7c\x15"
		"\xb8\xff\x97\x9c\xf5\x13\x4f\x31"
		"\xde\x67\xf7\x24\x73\xcd\x70\x1c"
		"\x03\x4a\xba\x8a\x87\x49\xfe\xdc"
		"\x75\x29\x62\x83\xae\x3f\x17\xab"
		"\xfd\x10\x4d\x8e\x17\x1c\x1f\xca",
	}
};

static const struct hash_testvec sha256_tv_template[] = {
	{
		.plaintext = "",
		.psize	= 0,
		.digest	= "\xe3\xb0\xc4\x42\x98\xfc\x1c\x14"
		"\x9a\xfb\xf4\xc8\x99\x6f\xb9\x24"
		"\x27\xae\x41\xe4\x64\x9b\x93\x4c"
		"\xa4\x95\x99\x1b\x78\x52\xb8\x55",
	}, {
		.plaintext = "abc",
		.psize	= 3,
		.digest	= "\xba\x78\x16\xbf\x8f\x01\xcf\xea"
		"\x41\x41\x40\xde\x5d\xae\x22\x23"
		"\xb0\x03\x61\xa3\x96\x17\x7a\x9c"
		"\xb4\x10\xff\x61\xf2\x00\x15\xad",
	}, {
		.plaintext = "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq",
		.psize	= 56,
		.digest	= "\x24\x8d\x6a\x61\xd2\x06\x38\xb8"
		"\xe5\xc0\x26\x93\x0c\x3e\x60\x39"
		"\xa3\x3c\xe4\x59\x64\xff\x21\x67"
		"\xf6\xec\xed\xd4\x19\xdb\x06\xc1",
	}, {
		.plaintext = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-",
		.psize	= 64,
		.digest = "\xb5\xfe\xad\x56\x7d\xff\xcb\xa4"
		"\x2c\x32\x29\x32\x19\xbb\xfb\xfa"
		"\xd6\xff\x94\xa3\x72\x91\x85\x66"
		"\x3b\xa7\x87\x77\x58\xa3\x40\x3a",
	}, {
		.plaintext = "\x08\x9f\x13\xaa\x41\xd8\x4c\xe3"
		"\x7a\x11\x85\x1c\xb3\x27\xbe\x55"
		"\xec\x60\xf7\x8e\x02\x99\x30\xc7"
		"\x3b\xd2\x69\x00\x74\x0b\xa2\x16"
		"\xad\x44\xdb\x4f\xe6\x7d\x14\x88"
		"\x1f\xb6\x2a\xc1\x58\xef\x63\xfa"
		"\x91\x05\x9c\x33\xca\x3e\xd5\x6c"
		"\x03\x77\x0e\xa5\x19\xb0\x47\xde"
		"\x52\xe9\x80\x17\x8b\x22\xb9\x2d"
		"\xc4\x5b\xf2\x66\xfd\x94\x08\x9f"
		"\x36\xcd\x41\xd8\x6f\x06\x7a\x11"
		"\xa8\x1c\xb3\x4a\xe1\x55\xec\x83"
		"\x1a\x8e\x25\xbc\x30\xc7\x5e\xf5"
		"\x69\x00\x97\x0b\xa2\x39\xd0\x44"
		"\xdb\x72\x09\x7d\x14\xab\x1f\xb6"
		"\x4d\xe4\x58\xef\x86\x1d\x91\x28"
		"\xbf\x33\xca\x61\xf8\x6c\x03\x9a"
		"\x0e\xa5\x3c\xd3\x47\xde\x75\x0c"
		"\x80\x17\xae\x22\xb9\x50\xe7\x5b"
		"\xf2\x89\x20\x94\x2b\xc2\x36\xcd"
		"\x64\xfb\x6f\x06\x9d\x11\xa8\x3f"
		"\xd6\x4a\xe1\x78\x0f\x83\x1a\xb1"
		"\x25\xbc\x53\xea\x5e\xf5\x8c\x00"
		"\x97\x2e\xc5\x39\xd0\x67\xfe\x72"
		"\x09\xa0\x14\xab\x42\xd9\x4d\xe4"
		"\x7b\x12\x86\x1d\xb4\x28\xbf\x56"
		"\xed\x61\xf8\x8f\x03\x9a\x31\xc8"
		"\x3c\xd3\x6a\x01\x75\x0c\xa3\x17"
		"\xae\x45\xdc\x50\xe7\x7e\x15\x89"
		"\x20\xb7\x2b\xc2\x59\xf0\x64\xfb"
		"\x92\x06\x9d\x34\xcb\x3f\xd6\x6d"
		"\x04\x78\x0f\xa6\x1a\xb1\x48\xdf"
		"\x53\xea\x81\x18\x8c\x23\xba\x2e"
		"\xc5\x5c\xf3\x67\xfe\x95\x09\xa0"
		"\x37\xce\x42\xd9\x70\x07\x7b\x12"
		"\xa9\x1d\xb4\x4b\xe2\x56\xed\x84"
		"\x1b\x8f\x26\xbd\x31\xc8\x5f\xf6"
		"\x6a\x01\x98\x0c\xa3\x3a\xd1\x45"
		"\xdc\x73\x0a\x7e\x15\xac\x20\xb7"
		"\x4e\xe5\x59\xf0\x87\x1e\x92\x29"
		"\xc0\x34\xcb\x62\xf9\x6d\x04\x9b"
		"\x0f\xa6\x3d\xd4\x48\xdf\x76\x0d"
		"\x81\x18\xaf\x23\xba\x51\xe8\x5c"
		"\xf3\x8a\x21\x95\x2c\xc3\x37\xce"
		"\x65\xfc\x70\x07\x9e\x12\xa9\x40"
		"\xd7\x4b\xe2\x79\x10\x84\x1b\xb2"
		"\x26\xbd\x54\xeb\x5f\xf6\x8d\x01"
		"\x98\x2f\xc6\x3a\xd1\x68\xff\x73"
		"\x0a\xa1\x15\xac\x43\xda\x4e\xe5"
		"\x7c\x13\x87\x1e\xb5\x29\xc0\x57"
		"\xee\x62\xf9\x90\x04\x9b\x32\xc9"
		"\x3d\xd4\x6b\x02\x76\x0d\xa4\x18"
		"\xaf\x46\xdd\x51\xe8\x7f\x16\x8a"
		"\x21\xb8\x2c\xc3\x5a\xf1\x65\xfc"
		"\x93\x07\x9e\x35\xcc\x40\xd7\x6e"
		"\x05\x79\x10\xa7\x1b\xb2\x49\xe0"
		"\x54\xeb\x82\x19\x8d\x24\xbb\x2f"
		"\xc6\x5d\xf4\x68\xff\x96\x0a\xa1"
		"\x38\xcf\x43\xda\x71\x08\x7c\x13"
		"\xaa\x1e\xb5\x4c\xe3\x57\xee\x85"
		"\x1c\x90\x27\xbe\x32\xc9\x60\xf7"
		"\x6b\x02\x99\x0d\xa4\x3b\xd2\x46"
		"\xdd\x74\x0b\x7f\x16\xad\x21\xb8"
		"\x4f\xe6\x5a\xf1\x88\x1f\x93\x2a"
		"\xc1\x35\xcc\x63\xfa\x6e\x05\x9c"
		"\x10\xa7\x3e\xd5\x49\xe0\x77\x0e"
		"\x82\x19\xb0\x24\xbb\x52\xe9\x5d"
		"\xf4\x8b\x22\x96\x2d\xc4\x38\xcf"
		"\x66\xfd\x71\x08\x9f\x13\xaa\x41"
		"\xd8\x4c\xe3\x7a\x11\x85\x1c\xb3"
		"\x27\xbe\x55\xec\x60\xf7\x8e\x02"
		"\x99\x30\xc7\x3b\xd2\x69\x00\x74"
		"\x0b\xa2\x16\xad\x44\xdb\x4f\xe6"
		"\x7d\x14\x88\x1f\xb6\x2a\xc1\x58"
		"\xef\x63\xfa\x91\x05\x9c\x33\xca"
		"\x3e\xd5\x6c\x03\x77\x0e\xa5\x19"
		"\xb0\x47\xde\x52\xe9\x80\x17\x8b"
		"\x22\xb9\x2d\xc4\x5b\xf2\x66\xfd"
		"\x94\x08\x9f\x36\xcd\x41\xd8\x6f"
		"\x06\x7a\x11\xa8\x1c\xb3\x4a\xe1"
		"\x55\xec\x83\x1a\x8e\x25\xbc\x30"
		"\xc7\x5e\xf5\x69\x00\x97\x0b\xa2"
		"\x39\xd0\x44\xdb\x72\x09\x7d\x14"
		"\xab\x1f\xb6\x4d\xe4\x58\xef\x86"
		"\x1d\x91\x28\xbf\x33\xca\x61\xf8"
		"\x6c\x03\x9a\x0e\xa5\x3c\xd3\x47"
		"\xde\x75\x0c\x80\x17\xae\x22\xb9"
		"\x50\xe7\x5b\xf2\x89\x20\x94\x2b"
		"\xc2\x36\xcd\x64\xfb\x6f\x06\x9d"
		"\x11\xa8\x3f\xd6\x4a\xe1\x78\x0f"
		"\x83\x1a\xb1\x25\xbc\x53\xea\x5e"
		"\xf5\x8c\x00\x97\x2e\xc5\x39\xd0"
		"\x67\xfe\x72\x09\xa0\x14\xab\x42"
		"\xd9\x4d\xe4\x7b\x12\x86\x1d\xb4"
		"\x28\xbf\x56\xed\x61\xf8\x8f\x03"
		"\x9a\x31\xc8\x3c\xd3\x6a\x01\x75"
		"\x0c\xa3\x17\xae\x45\xdc\x50\xe7"
		"\x7e\x15\x89\x20\xb7\x2b\xc2\x59"
		"\xf0\x64\xfb\x92\x06\x9d\x34\xcb"
		"\x3f\xd6\x6d\x04\x78\x0f\xa6\x1a"
		"\xb1\x48\xdf\x53\xea\x81\x18\x8c"
		"\x23\xba\x2e\xc5\x5c\xf3\x67\xfe"
		"\x95\x09\xa0\x37\xce\x42\xd9\x70"
		"\x07\x7b\x12\xa9\x1d\xb4\x4b\xe2"
		"\x56\xed\x84\x1b\x8f\x26\xbd\x31"
		"\xc8\x5f\xf6\x6a\x01\x98\x0c\xa3"
		"\x3a\xd1\x45\xdc\x73\x0a\x7e\x15"
		"\xac\x20\xb7\x4e\xe5\x59\xf0\x87"
		"\x1e\x92\x29\xc0\x34\xcb\x62\xf9"
		"\x6d\x04\x9b\x0f\xa6\x3d\xd4\x48"
		"\xdf\x76\x0d\x81\x18\xaf\x23\xba"
		"\x51\xe8\x5c\xf3\x8a\x21\x95\x2c"
		"\xc3\x37\xce\x65\xfc\x70\x07\x9e"
		"\x12\xa9\x40\xd7\x4b\xe2\x79\x10"
		"\x84\x1b\xb2\x26\xbd\x54\xeb\x5f"
		"\xf6\x8d\x01\x98\x2f\xc6\x3a\xd1"
		"\x68\xff\x73\x0a\xa1\x15\xac\x43"
		"\xda\x4e\xe5\x7c\x13\x87\x1e\xb5"
		"\x29\xc0\x57\xee\x62\xf9\x90\x04"
		"\x9b\x32\xc9\x3d\xd4\x6b\x02\x76"
		"\x0d\xa4\x18\xaf\x46\xdd\x51\xe8"
		"\x7f\x16\x8a\x21\xb8\x2c\xc3\x5a"
		"\xf1\x65\xfc\x93\x07\x9e\x35\xcc"
		"\x40\xd7\x6e\x05\x79\x10\xa7\x1b"
		"\xb2\x49\xe0\x54\xeb\x82\x19\x8d"
		"\x24\xbb\x2f\xc6\x5d\xf4\x68\xff"
		"\x96\x0a\xa1\x38\xcf\x43\xda\x71"
		"\x08\x7c\x13\xaa\x1e\xb5\x4c",
		.psize     = 1023,
		.digest    = "\xc5\xce\x0c\xca\x01\x4f\x53\x3a"
		"\x32\x32\x17\xcc\xd4\x6a\x71\xa9"
		"\xf3\xed\x50\x10\x64\x8e\x06\xbe"
		"\x9b\x4a\xa6\xbb\x05\x89\x59\x51",
	}
};

static int _sha_test(const struct hash_testvec *tv, int tv_len, enum hash_algo algo)
{
	const struct device *dev = device_get_binding(CONFIG_CRYPTO_ASPEED_HASH_DRV_NAME);
	int ret;
	int i;
	uint8_t digest[64];
	int fail = 0;

	struct hash_ctx ini;
	struct hash_pkt pkt;

	for (i = 0; i < tv_len; i++) {
		printk("tv[%d]:", i);

		pkt.in_buf = (uint8_t *)tv[i].plaintext;
		pkt.in_len = tv[i].psize;
		pkt.out_buf = digest;
		pkt.out_buf_max = sizeof(digest);

		ret = hash_begin_session(dev, &ini, algo);
		if (ret) {
			printk("hash_begin_session error");
			return ret;
		}

		ret = hash_update(&ini, &pkt);
		if (ret) {
			printk("hash_update error");
			goto out;
		}

		ret = hash_final(&ini, &pkt);
		if (ret) {
			printk("hash_final error");
			goto out;
		}

		hash_free_session(dev, &ini);

		if (!memcmp(digest, tv[i].digest, ini.digest_size)) {
			printk("PASS\n");
		} else {
			printk("FAIL\n");
			fail = 1;
		}
	}
	if (!fail)
		return 0;
	return 1;
out:
	hash_free_session(dev, &ini);
	return ret;
}

static int sha512_test(void)
{
	printk("sha512_test");
	return _sha_test(sha512_tv_template, ARRAY_SIZE(sha512_tv_template),
					 HASH_SHA512);
}

static int sha384_test(void)
{
	printk("sha384_test");
	return _sha_test(sha384_tv_template, ARRAY_SIZE(sha384_tv_template),
					 HASH_SHA384);
}

static int sha256_test(void)
{
	printk("sha256_test");
	return _sha_test(sha256_tv_template, ARRAY_SIZE(sha256_tv_template),
					 HASH_SHA256);
}


struct rsa_testvec {
	struct rsa_key k;
	char *p;
	char *c;
	unsigned int p_size;
	unsigned int c_size;
};

static struct rsa_testvec rsa_tv[] = {
	{
		.k = {
			.m =
			"\xDB\x10\x1A\xC2\xA3\xF1\xDC\xFF\x13\x6B\xED\x44\xDF\xF0\x02\x6D"
			"\x13\xC7\x88\xDA\x70\x6B\x54\xF1\xE8\x27\xDC\xC3\x0F\x99\x6A\xFA"
			"\xC6\x67\xFF\x1D\x1E\x3C\x1D\xC1\xB5\x5F\x6C\xC0\xB2\x07\x3A\x6D"
			"\x41\xE4\x25\x99\xAC\xFC\xD2\x0F\x02\xD3\xD1\x54\x06\x1A\x51\x77"
			"\xBD\xB6\xBF\xEA\xA7\x5C\x06\xA9\x5D\x69\x84\x45\xD7\xF5\x05\xBA"
			"\x47\xF0\x1B\xD7\x2B\x24\xEC\xCB\x9B\x1B\x10\x8D\x81\xA0\xBE\xB1"
			"\x8C\x33\xE4\x36\xB8\x43\xEB\x19\x2A\x81\x8D\xDE\x81\x0A\x99\x48"
			"\xB6\xF6\xBC\xCD\x49\x34\x3A\x8F\x26\x94\xE3\x28\x82\x1A\x7C\x8F"
			"\x59\x9F\x45\xE8\x5D\x1A\x45\x76\x04\x56\x05\xA1\xD0\x1B\x8C\x77"
			"\x6D\xAF\x53\xFA\x71\xE2\x67\xE0\x9A\xFE\x03\xA9\x85\xD2\xC9\xAA"
			"\xBA\x2A\xBC\xF4\xA0\x08\xF5\x13\x98\x13\x5D\xF0\xD9\x33\x34\x2A"
			"\x61\xC3\x89\x55\xF0\xAE\x1A\x9C\x22\xEE\x19\x05\x8D\x32\xFE\xEC"
			"\x9C\x84\xBA\xB7\xF9\x6C\x3A\x4F\x07\xFC\x45\xEB\x12\xE5\x7B\xFD"
			"\x55\xE6\x29\x69\xD1\xC2\xE8\xB9\x78\x59\xF6\x79\x10\xC6\x4E\xEB"
			"\x6A\x5E\xB9\x9A\xC7\xC4\x5B\x63\xDA\xA3\x3F\x5E\x92\x7A\x81\x5E"
			"\xD6\xB0\xE2\x62\x8F\x74\x26\xC2\x0C\xD3\x9A\x17\x47\xE6\x8E\xAB",
			.d =
			"\x52\x41\xF4\xDA\x7B\xB7\x59\x55\xCA\xD4\x2F\x0F\x3A\xCB\xA4\x0D"
			"\x93\x6C\xCC\x9D\xC1\xB2\xFB\xFD\xAE\x40\x31\xAC\x69\x52\x21\x92"
			"\xB3\x27\xDF\xEA\xEE\x2C\x82\xBB\xF7\x40\x32\xD5\x14\xC4\x94\x12"
			"\xEC\xB8\x1F\xCA\x59\xE3\xC1\x78\xF3\x85\xD8\x47\xA5\xD7\x02\x1A"
			"\x65\x79\x97\x0D\x24\xF4\xF0\x67\x6E\x75\x2D\xBF\x10\x3D\xA8\x7D"
			"\xEF\x7F\x60\xE4\xE6\x05\x82\x89\x5D\xDF\xC6\xD2\x6C\x07\x91\x33"
			"\x98\x42\xF0\x02\x00\x25\x38\xC5\x85\x69\x8A\x7D\x2F\x95\x6C\x43"
			"\x9A\xB8\x81\xE2\xD0\x07\x35\xAA\x05\x41\xC9\x1E\xAF\xE4\x04\x3B"
			"\x19\xB8\x73\xA2\xAC\x4B\x1E\x66\x48\xD8\x72\x1F\xAC\xF6\xCB\xBC"
			"\x90\x09\xCA\xEC\x0C\xDC\xF9\x2C\xD7\xEB\xAE\xA3\xA4\x47\xD7\x33"
			"\x2F\x8A\xCA\xBC\x5E\xF0\x77\xE4\x97\x98\x97\xC7\x10\x91\x7D\x2A"
			"\xA6\xFF\x46\x83\x97\xDE\xE9\xE2\x17\x03\x06\x14\xE2\xD7\xB1\x1D"
			"\x77\xAF\x51\x27\x5B\x5E\x69\xB8\x81\xE6\x11\xC5\x43\x23\x81\x04"
			"\x62\xFF\xE9\x46\xB8\xD8\x44\xDB\xA5\xCC\x31\x54\x34\xCE\x3E\x82"
			"\xD6\xBF\x7A\x0B\x64\x21\x6D\x88\x7E\x5B\x45\x12\x1E\x63\x8D\x49"
			"\xA7\x1D\xD9\x1E\x06\xCD\xE8\xBA\x2C\x8C\x69\x32\xEA\xBE\x60\x71",
			.e = "\x01\x00\x01",
			.m_bits = 2048,
			.d_bits = 2048,
			.e_bits = 24
		},
		.p = "\x54\x85\x9b\x34\x2c\x49\xea\x2a",
		.c =
		"\xb2\x97\x76\xb4\xae\x3e\x38\x3c\x7e\x64\x1f\xcc\xa2\x7f\xf6\xbe"
		"\xcf\x49\xbc\x48\xd3\x6c\x8f\x0a\x0e\xc1\x73\xbd\x7b\x55\x79\x36"
		"\x0e\xa1\x87\x88\xb9\x2c\x90\xa6\x53\x5e\xe9\xef\xc4\xe2\x4d\xdd"
		"\xf7\xa6\x69\x82\x3f\x56\xa4\x7b\xfb\x62\xe0\xae\xb8\xd3\x04\xb3"
		"\xac\x5a\x15\x2a\xe3\x19\x9b\x03\x9a\x0b\x41\xda\x64\xec\x0a\x69"
		"\xfc\xf2\x10\x92\xf3\xc1\xbf\x84\x7f\xfd\x2c\xae\xc8\xb5\xf6\x41"
		"\x70\xc5\x47\x03\x8a\xf8\xff\x6f\x3f\xd2\x6f\x09\xb4\x22\xf3\x30"
		"\xbe\xa9\x85\xcb\x9c\x8d\xf9\x8f\xeb\x32\x91\xa2\x25\x84\x8f\xf5"
		"\xdc\xc7\x06\x9c\x2d\xe5\x11\x2c\x09\x09\x87\x09\xa9\xf6\x33\x73"
		"\x90\xf1\x60\xf2\x65\xdd\x30\xa5\x66\xce\x62\x7b\xd0\xf8\x2d\x3d"
		"\x19\x82\x77\xe3\x0a\x5f\x75\x2f\x8e\xb1\xe5\xe8\x91\x35\x1b\x3b"
		"\x33\xb7\x66\x92\xd1\xf2\x8e\x6f\xe5\x75\x0c\xad\x36\xfb\x4e\xd0"
		"\x66\x61\xbd\x49\xfe\xf4\x1a\xa2\x2b\x49\xfe\x03\x4c\x74\x47\x8d"
		"\x9a\x66\xb2\x49\x46\x4d\x77\xea\x33\x4d\x6b\x3c\xb4\x49\x4a\xc6"
		"\x7d\x3d\xb5\xb9\x56\x41\x15\x67\x0f\x94\x3c\x93\x65\x27\xe0\x21"
		"\x5d\x59\xc3\x62\xd5\xa6\xda\x38\x26\x22\x5e\x34\x1c\x94\xaf\x98",
		.p_size = 8,
		.c_size = 256,
	},
};

static int rsa_test(void)
{
	const struct device *dev = device_get_binding(DT_LABEL(DT_INST(0, aspeed_rsa)));
	struct rsa_ctx ini;
	struct rsa_pkt pkt;
	struct rsa_key *rk;
	char plain_text[512];
	char cipher_text[512];
	int i, j;
	int ret;
	int fail = 0;

	for (i = 0; i < ARRAY_SIZE(rsa_tv); i++) {
		printf("rsa test vector[%d]:\n", i);
		rk = &rsa_tv[i].k;
		pkt.in_buf = rsa_tv[i].p;
		pkt.in_len = rsa_tv[i].p_size;
		pkt.out_buf = cipher_text;
		pkt.out_buf_max = 512;
		ret = rsa_begin_session(dev, &ini, rk);
		if (ret) {
			printf("rsa_begin_session fail: %d", ret);
			fail = 1;
			continue;
		}
		rsa_encrypt(&ini, &pkt);
		rsa_free_session(dev, &ini);
		ret = memcmp(cipher_text, rsa_tv[i].c, rsa_tv[i].c_size);
		if (ret != 0) {
			printf("enc fail: %d\n", ret);
			printf("input text:\n");
			for (j = 0; j < rsa_tv[i].p_size; j++) {
				printf("%02x", rsa_tv[i].p[j]);
				if ((j + 1) % 32 == 0)
					printf("\n");
			}
			printf("\n");
			printf("result text:\n");
			for (j = 0; j < rsa_tv[i].c_size; j++) {
				printf("%02x", cipher_text[j]);
				if ((j + 1) % 32 == 0)
					printf("\n");
			}
			printf("\n");
			fail = 1;
		} else {
			printf("enc pass\n");
		}

		pkt.in_buf = cipher_text;
		pkt.in_len = rsa_tv[i].c_size;
		pkt.out_buf = plain_text;
		pkt.out_buf_max = 512;
		ret = rsa_begin_session(dev, &ini, rk);
		if (ret) {
			printf("rsa_begin_session fail: %d", ret);
			fail = 1;
			continue;
		}
		rsa_decrypt(&ini, &pkt);
		rsa_free_session(dev, &ini);
		ret = memcmp(plain_text, rsa_tv[i].p, rsa_tv[i].p_size);
		if (ret != 0) {
			printf("dec fail: %d\n", ret);
			printf("input text:\n");
			for (j = 0; j < rsa_tv[i].c_size; j++) {
				printf("%02x", cipher_text[j]);
				if ((j + 1) % 32 == 0)
					printf("\n");
			}
			printf("result text:\n");
			for (j = 0; j < rsa_tv[i].p_size; j++) {
				printf("%02x", plain_text[j]);
				if ((j + 1) % 32 == 0)
					printf("\n");
			}
			printf("\n");
			fail = 1;
		} else {
			printf("dec pass\n");
		}
	}
	if (!fail)
		return 0;
	return 1;
}

int test_crypto(int count, enum aspeed_test_type type)
{
	printk("%s, count: %d, type: %d\n", __func__, count, type);

	ast_zassert_equal(sha256_test(), 0, "sha256 test failed");
	ast_zassert_equal(sha384_test(), 0, "sha256 test failed");
	ast_zassert_equal(sha512_test(), 0, "sha256 test failed");
	ast_zassert_equal(rsa_test(), 0, "rsa test failed");

	return ast_ztest_result();
}
